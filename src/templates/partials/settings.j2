{% if htmx %}

<title hx-swap-oob="true">Settings - Signpost</title>

<section hx-swap-oob="true" id="nav">
{% include "components/navbar.j2" %}
</section>

{% endif %}

<h2>Settings</h2>

<h3>Change password</h3>

{% for field, error_list in form.errors.items() %}

{% for error in error_list %}
    <p style="color: red;">{{ error }}</p>
{% endfor %}

{% endfor %}

<p style="color: green;">{{ status_message|default("") }}</p>

<form hx-target="#content-block" hx-swap="innerHTML" hx-post="/api/settings/change_password">

{{ form.csrf_token }}

{{ form.old_password.label }}
{{ form.old_password() }}

{{ form.new_password.label }}
{{ form.new_password() }}

{{ form.confirm_password.label }}
{{ form.confirm_password() }}

<input type="submit" value="Change"/>

</form>

<br>

<p id="api-secret"></p>

<button hx-target="#api-secret" hx-get="/api/settings/secret/view">View API Key</button>
<button hx-target="#api-secret" hx-get="/api/settings/secret/regenerate" hx-confirm="Are you sure you want to regenerate the key? This will break any applications using it.">Regenerate API Key</button>